import{_ as D}from"./AuthenticatedLayout-DitEw9wP.js";import{j as A,c as l,o as a,a as c,u as n,Z as L,w as g,b as e,d as m,t as o,F as p,r as h,n as b,i as x,h as y,k as f,N as S}from"./app-BEZNL6kN.js";import"./ApplicationLogo-TP7P839r.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"flex justify-between items-center"},M={class:"py-12"},N={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},T={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},j={class:"p-6"},E={key:0,class:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},I={key:1,class:"overflow-x-auto"},B={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},H={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},V={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},$={class:"px-6 py-4 whitespace-nowrap"},z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},F={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},O={class:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400 max-w-xs truncate"},R={class:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},U=["onClick","disabled"],q={key:2,class:"text-center py-8"},J={class:"text-gray-500 dark:text-gray-400"},P={key:3,class:"mt-6"},W={class:"flex items-center justify-between border-t border-gray-200 dark:border-gray-600 pt-6"},Z={class:"flex-1 flex justify-between sm:hidden"},G={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},K={class:"text-sm text-gray-700 dark:text-gray-300"},Q={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},X=["innerHTML"],ae={__name:"Index",props:{alerts:{type:Object,required:!0}},setup(d){const u=A(null),k=s=>{const t={critical:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",high:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"};return t[String(s).toLowerCase()]||t.medium},v=s=>({critical:"Critical",high:"High",medium:"Medium",low:"Low"})[String(s).toLowerCase()]||"Medium",w=s=>{if(!s)return"N/A";try{const t=new Date(s);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}},_=s=>{if(!s){alert("Error: Missing alert ID!");return}if(!confirm("Are you sure you want to delete this alert?"))return;u.value=s;const t=`/alerts/${encodeURIComponent(s)}`;console.log("[deleteAlert] Deleting alert ID:",s),console.log("[deleteAlert] DELETE URL:",t),S.delete(t,{preserveScroll:!0,onStart:()=>{console.log("[deleteAlert] Request started")},onSuccess:()=>{console.log("[deleteAlert] Delete successful"),u.value=null},onError:i=>{console.error("[deleteAlert] Delete failed:",i),u.value=null;let r="Failed to delete alert.";i.message&&(r+=" Error: "+i.message),i.errors&&Object.keys(i.errors).length>0&&(r+=" Details: "+JSON.stringify(i.errors)),alert(r)},onFinish:()=>{u.value=null}})};return(s,t)=>(a(),l(p,null,[c(n(L),{title:"Alerts"}),c(D,null,{header:g(()=>[e("div",C,[t[1]||(t[1]=e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Security Alerts ",-1)),c(n(x),{href:s.route("alerts.create"),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:g(()=>[...t[0]||(t[0]=[y(" Create New Alert ",-1)])]),_:1},8,["href"])])]),default:g(()=>{var i;return[e("div",M,[e("div",N,[e("div",T,[e("div",j,[(i=s.$page.props.flash)!=null&&i.success?(a(),l("div",E,o(s.$page.props.flash.success),1)):m("",!0),d.alerts.data.length>0?(a(),l("div",I,[e("table",B,[t[4]||(t[4]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Attack Type "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Severity "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Detected At "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," ML Model "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Description "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",H,[(a(!0),l(p,null,h(d.alerts.data,r=>(a(),l("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",V,o(r.attack_type),1),e("td",$,[e("span",{class:b([k(r.severity),"px-2 py-1 text-xs font-semibold rounded-full"])},o(v(r.severity)),3)]),e("td",z,o(w(r.detected_at)),1),e("td",F,o(r.ml_model?r.ml_model.name:"Default IDS Model"),1),e("td",O,o(r.description||"No description available"),1),e("td",R,[c(n(x),{href:s.route("alerts.show",r.id),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400"},{default:g(()=>[...t[2]||(t[2]=[y(" View ",-1)])]),_:1},8,["href"]),c(n(x),{href:s.route("alerts.edit",r.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400"},{default:g(()=>[...t[3]||(t[3]=[y(" Edit ",-1)])]),_:1},8,["href"]),e("button",{onClick:Y=>_(r.id),disabled:u.value===r.id,class:"text-red-600 hover:text-red-900 dark:text-red-400 disabled:opacity-50"},o(u.value===r.id?"Deleting...":"Delete"),9,U)])]))),128))])])])):(a(),l("div",q,[e("div",J,[t[6]||(t[6]=e("svg",{class:"mx-auto h-12 w-12 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),t[7]||(t[7]=e("p",{class:"text-lg"},"No alerts detected yet",-1)),t[8]||(t[8]=e("p",{class:"text-sm mt-2"},"When threats are detected, they will appear here.",-1)),c(n(x),{href:s.route("alerts.create"),class:"mt-4 inline-flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-700 text-white font-bold rounded"},{default:g(()=>[...t[5]||(t[5]=[y(" Create Test Alert ",-1)])]),_:1},8,["href"])])])),d.alerts.links&&d.alerts.links.length>3?(a(),l("div",P,[e("nav",W,[e("div",Z,[d.alerts.prev_page_url?(a(),f(n(x),{key:0,href:d.alerts.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},{default:g(()=>[...t[9]||(t[9]=[y(" Previous ",-1)])]),_:1},8,["href"])):m("",!0),d.alerts.next_page_url?(a(),f(n(x),{key:1,href:d.alerts.next_page_url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"},{default:g(()=>[...t[10]||(t[10]=[y(" Next ",-1)])]),_:1},8,["href"])):m("",!0)]),e("div",G,[e("div",null,[e("p",K," Showing "+o(d.alerts.from||0)+" to "+o(d.alerts.to||0)+" of "+o(d.alerts.total||0)+" results ",1)]),e("div",null,[e("nav",Q,[(a(!0),l(p,null,h(d.alerts.links,r=>(a(),l(p,{key:r.label},[r.url?(a(),f(n(x),{key:0,href:r.url,innerHTML:r.label,class:b(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",r.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600 dark:bg-indigo-900 dark:border-indigo-400 dark:text-indigo-200":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700"])},null,8,["href","innerHTML","class"])):(a(),l("span",{key:1,innerHTML:r.label,class:b(["relative inline-flex items-center px-4 py-2 border border-gray-300 bg-gray-50 text-sm font-medium","cursor-not-allowed opacity-50 text-gray-400 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500"])},null,8,X))],64))),128))])])])])])):m("",!0)])])])])]}),_:1})],64))}};export{ae as default};
