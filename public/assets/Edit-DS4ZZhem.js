import{T as h,c as i,o as a,a as c,u as o,Z as S,w as y,b as e,e as M,f as u,d as m,F as k,r as w,t as l,v as b,g as f,i as x,h as v}from"./app-BEZNL6kN.js";import{_ as V}from"./AuthenticatedLayout-DitEw9wP.js";import"./ApplicationLogo-TP7P839r.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"flex justify-between items-center"},A={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},L={class:"flex space-x-2"},D={class:"py-12"},P={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},B={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},E={class:"p-6"},j={class:"mb-6"},C=["value"],N={key:0,class:"text-red-600 text-sm mt-1"},O={class:"mb-6"},q=["value"],F={key:0,class:"text-red-600 text-sm mt-1"},I={class:"mb-6"},T={key:0,class:"text-red-600 text-sm mt-1"},Q={class:"mb-6"},X={key:0,class:"text-red-600 text-sm mt-1"},H={class:"mb-6"},R={key:0,class:"text-red-600 text-sm mt-1"},Z={class:"mb-6"},$={key:0,class:"text-red-600 text-sm mt-1"},z={class:"mb-6"},G={key:0,class:"text-red-600 text-sm mt-1"},J={class:"mb-6"},K={key:0,class:"text-red-600 text-sm mt-1"},W={class:"mb-6"},Y={key:0,class:"text-red-600 text-sm mt-1"},ee={class:"flex items-center justify-end"},te=["disabled"],re={key:0},oe={key:1},le={__name:"Edit",props:{alert:{type:Object,required:!0},networkLogs:{type:Array,default:()=>[]},mlModels:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},setup(s){const n=s,d=h({network_log_id:n.alert.network_log_id,ml_model_id:n.alert.ml_model_id,attack_type:n.alert.attack_type,severity:n.alert.severity,status:n.alert.status,source_ip:n.alert.source_ip||"",destination_ip:n.alert.destination_ip||"",confidence_score:n.alert.confidence_score||"",description:n.alert.description||""}),_=()=>{d.put(route("alerts.update",n.alert.id),{onSuccess:()=>{},onError:g=>{console.log("Validation errors:",g)}})},{processing:p}=d;return(g,t)=>(a(),i(k,null,[c(o(S),{title:"Edit Alert"}),c(V,null,{header:y(()=>[e("div",U,[e("h2",A," Edit Alert #"+l(s.alert.id),1),e("div",L,[c(o(x),{href:g.route("alerts.show",s.alert.id),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"},{default:y(()=>[...t[9]||(t[9]=[v(" View Alert ",-1)])]),_:1},8,["href"]),c(o(x),{href:g.route("alerts.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:y(()=>[...t[10]||(t[10]=[v(" Back to Alerts ",-1)])]),_:1},8,["href"])])])]),default:y(()=>[e("div",D,[e("div",P,[e("div",B,[e("div",E,[e("form",{onSubmit:M(_,["prevent"])},[e("div",j,[t[12]||(t[12]=e("label",{for:"network_log_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Network Log ",-1)),u(e("select",{id:"network_log_id","onUpdate:modelValue":t[0]||(t[0]=r=>o(d).network_log_id=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[11]||(t[11]=e("option",{value:""},"Select a network log",-1)),(a(!0),i(k,null,w(s.networkLogs,r=>(a(),i("option",{key:r.id,value:r.id},l(r.filename)+" ("+l(r.upload_date)+") ",9,C))),128))],512),[[b,o(d).network_log_id]]),s.errors.network_log_id?(a(),i("div",N,l(s.errors.network_log_id),1)):m("",!0)]),e("div",O,[t[14]||(t[14]=e("label",{for:"ml_model_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," ML Model ",-1)),u(e("select",{id:"ml_model_id","onUpdate:modelValue":t[1]||(t[1]=r=>o(d).ml_model_id=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[13]||(t[13]=e("option",{value:""},"Select an ML model",-1)),(a(!0),i(k,null,w(s.mlModels,r=>(a(),i("option",{key:r.id,value:r.id},l(r.name),9,q))),128))],512),[[b,o(d).ml_model_id]]),s.errors.ml_model_id?(a(),i("div",F,l(s.errors.ml_model_id),1)):m("",!0)]),e("div",I,[t[16]||(t[16]=e("label",{for:"attack_type",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Attack Type ",-1)),u(e("select",{id:"attack_type","onUpdate:modelValue":t[2]||(t[2]=r=>o(d).attack_type=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[...t[15]||(t[15]=[e("option",{value:""},"Select attack type",-1),e("option",{value:"DDoS"},"DDoS",-1),e("option",{value:"SQL Injection"},"SQL Injection",-1),e("option",{value:"XSS"},"XSS (Cross-Site Scripting)",-1),e("option",{value:"Port Scan"},"Port Scan",-1),e("option",{value:"Brute Force"},"Brute Force",-1),e("option",{value:"Malware"},"Malware",-1),e("option",{value:"Phishing"},"Phishing",-1),e("option",{value:"Man-in-the-Middle"},"Man-in-the-Middle",-1),e("option",{value:"Buffer Overflow"},"Buffer Overflow",-1),e("option",{value:"Privilege Escalation"},"Privilege Escalation",-1)])],512),[[b,o(d).attack_type]]),s.errors.attack_type?(a(),i("div",T,l(s.errors.attack_type),1)):m("",!0)]),e("div",Q,[t[18]||(t[18]=e("label",{for:"severity",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Severity Level ",-1)),u(e("select",{id:"severity","onUpdate:modelValue":t[3]||(t[3]=r=>o(d).severity=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[...t[17]||(t[17]=[e("option",{value:""},"Select severity",-1),e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1),e("option",{value:"critical"},"Critical",-1)])],512),[[b,o(d).severity]]),s.errors.severity?(a(),i("div",X,l(s.errors.severity),1)):m("",!0)]),e("div",H,[t[20]||(t[20]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Status ",-1)),u(e("select",{id:"status","onUpdate:modelValue":t[4]||(t[4]=r=>o(d).status=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[...t[19]||(t[19]=[e("option",{value:"new"},"New",-1),e("option",{value:"investigating"},"Investigating",-1),e("option",{value:"resolved"},"Resolved",-1),e("option",{value:"false_positive"},"False Positive",-1)])],512),[[b,o(d).status]]),s.errors.status?(a(),i("div",R,l(s.errors.status),1)):m("",!0)]),e("div",Z,[t[21]||(t[21]=e("label",{for:"source_ip",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Source IP Address (Optional) ",-1)),u(e("input",{type:"text",id:"source_ip","onUpdate:modelValue":t[5]||(t[5]=r=>o(d).source_ip=r),placeholder:"e.g., 192.168.1.100",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).source_ip]]),s.errors.source_ip?(a(),i("div",$,l(s.errors.source_ip),1)):m("",!0)]),e("div",z,[t[22]||(t[22]=e("label",{for:"destination_ip",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Destination IP Address (Optional) ",-1)),u(e("input",{type:"text",id:"destination_ip","onUpdate:modelValue":t[6]||(t[6]=r=>o(d).destination_ip=r),placeholder:"e.g., 10.0.0.1",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).destination_ip]]),s.errors.destination_ip?(a(),i("div",G,l(s.errors.destination_ip),1)):m("",!0)]),e("div",J,[t[23]||(t[23]=e("label",{for:"confidence_score",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Confidence Score (0.0 - 1.0) ",-1)),u(e("input",{type:"number",id:"confidence_score","onUpdate:modelValue":t[7]||(t[7]=r=>o(d).confidence_score=r),step:"0.01",min:"0",max:"1",placeholder:"e.g., 0.95",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).confidence_score]]),s.errors.confidence_score?(a(),i("div",K,l(s.errors.confidence_score),1)):m("",!0)]),e("div",W,[t[24]||(t[24]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description ",-1)),u(e("textarea",{id:"description","onUpdate:modelValue":t[8]||(t[8]=r=>o(d).description=r),rows:"4",placeholder:"Detailed description of the detected threat...",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).description]]),s.errors.description?(a(),i("div",Y,l(s.errors.description),1)):m("",!0)]),e("div",ee,[c(o(x),{href:g.route("alerts.index"),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded mr-4"},{default:y(()=>[...t[25]||(t[25]=[v(" Cancel ",-1)])]),_:1},8,["href"]),e("button",{type:"submit",disabled:o(p),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50"},[o(p)?(a(),i("span",re,"Updating...")):(a(),i("span",oe,"Update Alert"))],8,te)])],32)])])])])]),_:1})],64))}};export{le as default};
