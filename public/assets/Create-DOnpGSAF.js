import{T as h,c as i,o as a,a as g,u as o,Z as S,w as c,b as e,d as n,t as l,F as b,r as k,e as M,f as u,v as y,g as f,i as p,h as v}from"./app-BEZNL6kN.js";import{_ as V}from"./AuthenticatedLayout-DitEw9wP.js";import"./ApplicationLogo-TP7P839r.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"flex justify-between items-center"},A={class:"py-12"},L={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},D={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},P={class:"p-6"},B={key:0,class:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},U={key:1,class:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},j={class:"list-disc list-inside"},N={class:"mb-6"},F=["value"],q={key:0,class:"text-red-600 text-sm mt-1"},E={class:"mb-6"},I=["value"],O={key:0,class:"text-red-600 text-sm mt-1"},T={class:"mb-6"},$={key:0,class:"text-red-600 text-sm mt-1"},Q={class:"mb-6"},X={key:0,class:"text-red-600 text-sm mt-1"},H={class:"mb-6"},Z={key:0,class:"text-red-600 text-sm mt-1"},z={class:"mb-6"},G={key:0,class:"text-red-600 text-sm mt-1"},J={class:"mb-6"},K={key:0,class:"text-red-600 text-sm mt-1"},R={class:"mb-6"},W={key:0,class:"text-red-600 text-sm mt-1"},Y={class:"flex items-center justify-end"},ee=["disabled"],te={key:0},re={key:1},ae={__name:"Create",props:{networkLogs:{type:Array,default:()=>[]},mlModels:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},setup(s){const d=h({network_log_id:"",ml_model_id:"",attack_type:"",severity:"",source_ip:"",destination_ip:"",confidence_score:"",description:""}),w=()=>{console.log("Form data before submit:",d.data()),d.post("/alerts",{onSuccess:()=>{console.log("Alert created successfully")},onError:m=>{console.log("Validation errors:",m)}})};return(m,t)=>(a(),i(b,null,[g(o(S),{title:"Create Alert"}),g(V,null,{header:c(()=>[e("div",C,[t[9]||(t[9]=e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Create New Alert ",-1)),g(o(p),{href:"/alerts",class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:c(()=>[...t[8]||(t[8]=[v(" Back to Alerts ",-1)])]),_:1})])]),default:c(()=>{var x;return[e("div",A,[e("div",L,[e("div",D,[e("div",P,[(x=m.$page.props.flash)!=null&&x.success?(a(),i("div",B,l(m.$page.props.flash.success),1)):n("",!0),Object.keys(s.errors).length>0?(a(),i("div",U,[t[10]||(t[10]=e("h4",{class:"font-bold mb-2"},"Please fix the following errors:",-1)),e("ul",j,[(a(!0),i(b,null,k(s.errors,(r,_)=>(a(),i("li",{key:_},l(r),1))),128))])])):n("",!0),e("form",{onSubmit:M(w,["prevent"])},[e("div",N,[t[12]||(t[12]=e("label",{for:"network_log_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Network Log ",-1)),u(e("select",{id:"network_log_id","onUpdate:modelValue":t[0]||(t[0]=r=>o(d).network_log_id=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[11]||(t[11]=e("option",{value:""},"Select a network log",-1)),(a(!0),i(b,null,k(s.networkLogs,r=>(a(),i("option",{key:r.id,value:r.id},l(r.filename)+" - "+l(r.uploaddate),9,F))),128))],512),[[y,o(d).network_log_id]]),s.errors.network_log_id?(a(),i("div",q,l(s.errors.network_log_id),1)):n("",!0)]),e("div",E,[t[14]||(t[14]=e("label",{for:"ml_model_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," ML Model ",-1)),u(e("select",{id:"ml_model_id","onUpdate:modelValue":t[1]||(t[1]=r=>o(d).ml_model_id=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[13]||(t[13]=e("option",{value:""},"Select an ML model",-1)),(a(!0),i(b,null,k(s.mlModels,r=>(a(),i("option",{key:r.id,value:r.id},l(r.name),9,I))),128))],512),[[y,o(d).ml_model_id]]),s.errors.ml_model_id?(a(),i("div",O,l(s.errors.ml_model_id),1)):n("",!0)]),e("div",T,[t[16]||(t[16]=e("label",{for:"attack_type",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Attack Type ",-1)),u(e("select",{id:"attack_type","onUpdate:modelValue":t[2]||(t[2]=r=>o(d).attack_type=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[...t[15]||(t[15]=[e("option",{value:""},"Select attack type",-1),e("option",{value:"DDoS"},"DDoS",-1),e("option",{value:"SQL Injection"},"SQL Injection",-1),e("option",{value:"XSS"},"XSS (Cross-Site Scripting)",-1),e("option",{value:"Port Scan"},"Port Scan",-1),e("option",{value:"Brute Force"},"Brute Force",-1),e("option",{value:"Malware"},"Malware",-1),e("option",{value:"Phishing"},"Phishing",-1),e("option",{value:"Man-in-the-Middle"},"Man-in-the-Middle",-1),e("option",{value:"Buffer Overflow"},"Buffer Overflow",-1),e("option",{value:"Privilege Escalation"},"Privilege Escalation",-1)])],512),[[y,o(d).attack_type]]),s.errors.attack_type?(a(),i("div",$,l(s.errors.attack_type),1)):n("",!0)]),e("div",Q,[t[18]||(t[18]=e("label",{for:"severity",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Severity Level ",-1)),u(e("select",{id:"severity","onUpdate:modelValue":t[3]||(t[3]=r=>o(d).severity=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[...t[17]||(t[17]=[e("option",{value:""},"Select severity",-1),e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1),e("option",{value:"critical"},"Critical",-1)])],512),[[y,o(d).severity]]),s.errors.severity?(a(),i("div",X,l(s.errors.severity),1)):n("",!0)]),e("div",H,[t[19]||(t[19]=e("label",{for:"source_ip",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Source IP Address ",-1)),u(e("input",{type:"text",id:"source_ip","onUpdate:modelValue":t[4]||(t[4]=r=>o(d).source_ip=r),placeholder:"e.g., 192.168.1.100",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).source_ip]]),s.errors.source_ip?(a(),i("div",Z,l(s.errors.source_ip),1)):n("",!0)]),e("div",z,[t[20]||(t[20]=e("label",{for:"destination_ip",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Destination IP Address ",-1)),u(e("input",{type:"text",id:"destination_ip","onUpdate:modelValue":t[5]||(t[5]=r=>o(d).destination_ip=r),placeholder:"e.g., 10.0.0.1",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).destination_ip]]),s.errors.destination_ip?(a(),i("div",G,l(s.errors.destination_ip),1)):n("",!0)]),e("div",J,[t[21]||(t[21]=e("label",{for:"confidence_score",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Confidence Score (0.0 - 1.0) ",-1)),u(e("input",{type:"number",id:"confidence_score","onUpdate:modelValue":t[6]||(t[6]=r=>o(d).confidence_score=r),step:"0.01",min:"0",max:"1",placeholder:"e.g., 0.95",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).confidence_score]]),s.errors.confidence_score?(a(),i("div",K,l(s.errors.confidence_score),1)):n("",!0)]),e("div",R,[t[22]||(t[22]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description ",-1)),u(e("textarea",{id:"description","onUpdate:modelValue":t[7]||(t[7]=r=>o(d).description=r),rows:"4",placeholder:"Detailed description of the detected threat...",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[f,o(d).description]]),s.errors.description?(a(),i("div",W,l(s.errors.description),1)):n("",!0)]),e("div",Y,[g(o(p),{href:"/alerts",class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded mr-4"},{default:c(()=>[...t[23]||(t[23]=[v(" Cancel ",-1)])]),_:1}),e("button",{type:"submit",disabled:o(d).processing,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50"},[o(d).processing?(a(),i("span",te,"Creating...")):(a(),i("span",re,"Create Alert"))],8,ee)])],32)])])])])]}),_:1})],64))}};export{ae as default};
